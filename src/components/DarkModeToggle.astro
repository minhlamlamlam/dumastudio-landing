---
// Dark mode toggle component
---

<button
  id="theme-toggle"
  type="button"
  class="fixed top-6 right-6 p-3 rounded-full bg-gray-100 dark:bg-gray-900 hover:bg-gray-200 dark:hover:bg-gray-800 transition-all duration-300 z-50 group"
  aria-label="Toggle dark mode"
>
  <svg
    class="w-5 h-5 fill-current text-gray-800 dark:text-gray-200 sun-icon"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
  >
    <path
      d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"
    ></path>
  </svg>
  <svg
    class="w-5 h-5 fill-current text-gray-800 dark:text-gray-200 moon-icon hidden"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 24 24"
  >
    <path
      d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"
    ></path>
  </svg>
</button>

<script>
  const getInitialTheme = (): 'light' | 'dark' => {
    if (typeof localStorage !== 'undefined') {
      const stored = localStorage.getItem('theme');
      if (stored === 'light' || stored === 'dark') {
        return stored;
      }
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  };

  const theme = getInitialTheme();

  if (theme === 'light') {
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle('dark');

    const isDark = element.classList.contains('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');

    // Toggle icon visibility
    document.querySelector('.sun-icon')?.classList.toggle('hidden');
    document.querySelector('.moon-icon')?.classList.toggle('hidden');
  };

  document.getElementById('theme-toggle')?.addEventListener('click', handleToggleClick);

  // Set initial icon state
  const isDark = document.documentElement.classList.contains('dark');
  if (isDark) {
    document.querySelector('.sun-icon')?.classList.add('hidden');
    document.querySelector('.moon-icon')?.classList.remove('hidden');
  }
</script>

<style>
  button {
    backdrop-filter: blur(8px);
  }
</style>
